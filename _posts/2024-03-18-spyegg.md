---
layout: single
title: "Spyegg A to Z"
categories: [Data Science]
tag: []
typora-root-url: ../
use_math: true


---

# <img src="/images/2024-03-18-spyegg/image-20240318200615756.png" alt="image-20240318200615756" style="zoom:50%;" />





2023 농림축산식품부 공공빅데이터 창업경진대회 서비스 및 개발 부문에 참여한 '스파이에그' 프로젝트에 대한 전체적인 내용을 작성하기 위해 포스트를 올린다.

스파이에그 프로젝트는 파각란 방지를 위한 농장에서 유통까지 전주기를 모니터링을 목표로 하는 프로젝트이다.



## **개요**



계란 시장의 규모는 2조 1천억원이나 된다. 이 방대한 시장에서 파각란 최소화는 핵심 이슈로 대두된다. 

파각란이란 난각에 금이 가지만 내용물이 누출되지 않은 계란을 말하는데, 사진과 같이 잘 보이지 않는 계란껍질에 실금이 있는 계란을 의미한다. 

<img src="/images/2024-03-18-spyegg/image-20240318201525034.png" alt="image-20240318201525034" style="zoom:25%;" /><img src="/images/2024-03-18-spyegg/image-20240318201610073.png" alt="image-20240318201610073" style="zoom:25%;" />



파각란은 이 실금을 통해서 껍질의 뭍어있는 오염물 혹은 세균 침입 위험성이 높 아지고 완전히 깨질 파란이 될 높은 가능성을 포함하고 있어, 축평원에서 등급을 낮추는 원인 으로 작용하고 있다.

<img src="/images/2024-03-18-spyegg/image-20240318201752130.png" alt="image-20240318201752130" style="zoom:25%;" />



계란 등급평가는 표본 추출 검사로 진행되는데, 계란 등급 판정 검사에서 파각란이 7%이상으로 검출될 경우, 전체 모집단의 계란은 한단계 낮은 등급을 부여받게 된다. 등급에 따라 수 입이 결정되는 농가에는 당연히 수입 감소로 이어진다.

<img src="/images/2024-03-18-spyegg/image-20240318202118909.png" alt="image-20240318202118909" style="zoom:25%;" />

축산 과학원에서 조사한 파각란의 비율에 따르면, 약 **5.4%**의 파각란이 출현한다. 흔히 우리들이 먹는 1판의 계란, 30개의 계란 중 1.5개가 파각란인 샘이며, 이렇게 검출된 파각란 은 가공용으로 보통란보다 **1/3**가격으로 낮은 가격을 납품되게 된다, 그렇기에 농장에서 파각란을 효과적으로 관리하는 것은 매우 중요한 요소이다.



## **문제 제기**



<img src="/images/2024-03-18-spyegg/image-20240318202242240.png" alt="image-20240318202242240" style="zoom:25%;" />



이런 파각란의 첫 번째 원인은 계란의 난각두께 감소가 원인이다. 산란계의 칼슘과 같은 영양소의 결핍, 혹은 스트레스 질병 등의 이유로 난각의 두께가 얇아지는 경우가 원인이 될 수 있다. 



<img src="/images/2024-03-18-spyegg/image-20240318202255363.png" alt="image-20240318202255363" style="zoom: 33%;" />

2번째는 **더 근본적인 이유로 계란 생산에서 유통 과정 중 발생하는 물리적 충격이다**. 아무리 계란 껍질이 얇다 해도 물리적 충격이 없다면 파각란은 생산되지 않는다.

그러나 그동안 산란계의 영양 상태 개선과 농장 환경 조성 외의 방법은 부족하였다. 난각의 두께에 영향을 미치는 것은 영양상태 뿐만 아니라, 산란계의 월령 혹은 다른 원인에 영향을 받곤 한다. 조건에 따라 대처 방법의 효과성이 차이가 나게 되는 것이다. 그러므로 농가에서 필요한 것은 **근본적인 파각란 발생의 원인인 물리적 충격을 측정하고 대처하는 방법이다.**

<img src="/images/2024-03-18-spyegg/image-20240318203347455.png" alt="image-20240318203347455" style="zoom:50%;" />

 농가에서부터 닭이 알을 낳고 생산되며, 농가에 따라 자동화 레일 혹은 사람에 의해 운반 되고 세척후에, 등급이 매겨지는 Grading & Packing 센터를 지나 도,소매점에서 식탁으로 오게 된다. 이 과정에서 발생하는 **물리적 충격들과, 저장과정 중에 발생하는 지속적인 압력이 난각에 미세한 실금을 만드는 근본적인 원인이 된다.**



<img src="/images/2024-03-18-spyegg/image-20240318203415582.png" alt="image-20240318203415582" style="zoom:40%;" />

그간 농가에서는 관능평가로 문제를 해결하곤 했다. 경험에 의거해서 사람이 직접 보 고 피부로 느끼며, 문제를 받아드리고 해결해왔다.

팀 공공의 란은 스파이에그 프로젝트를 통해 기존 볼 수 없는 충격량이 어디가 발생되는지, 어느 시간동안 누적되는지에 대해서 정량적인 측정을 통해 누구나 객관적이고 절대적인 판단을 내릴 수 있도록 할 수 있도록 할 것이다.



## **개발**

<img src="/images/2024-03-18-spyegg/image-20240318203628384.png" alt="image-20240318203628384" style="zoom:50%;" />

그 역할을 바로 이 '**SpyEgg**'가 해낼 것이다. 'SpyEgg'은 계란과 동일한 모양의 센서로, 계란의 유통 과정 중 파각란 발생에 영향을 미치는 리스크 포인트를 실시간으로 예측하고 분석할 수 있다. 

이 스파이에그는 계란의 대란 사이즈를 모방하여 만들어졌다. 

**3축 가속도 센서**와 **3축 자이로 센서**, 자체적인 **온도 센서**와 **리튬-폴리머 배터리**, **무선통신 장치**를 탑재하고 있다. 

6개 축을 이용한 센서는 계란의 현 상태와 상태 변화값을 정량적으로 측정해낸다. 

또한 내장된 온도센서를 통해 온도 변화로 인한 리스크를 측정해 낼 수 있다.

<img src="/images/2024-03-18-spyegg/image-20240318203829695.png" alt="image-20240318203829695" style="zoom: 33%;" />

위 사항들을 해내기 위해서 자체적인 데이터를 만들었다. 

계란의 크기와 난각 두께에 따라 계란의 중심부 온도와 충격량을 측정하고, 크기와 난각 두께에 따른 파각 임계점을 설정하였다. 

충격량을 실험하기 위해 일정한 충격량을 설정해 타격하고, 층별로 쌓아 시간에 따른 압력 누적량을 측정하였다.

<img src="/images/2024-03-18-spyegg/image-20240318204023786.png" alt="image-20240318204023786" style="zoom: 33%;" />

'SpyEgg'의 핵심 기능은 물리적 충격량 측정이다. 

계란들과 생산과 유통 과정의 여정을 함께하며, 충격량을 측정한다. 

물리적 충격이 원인일 경우 해당 포인트를 찾아 개선하고, 물리적 충격 외가 문제일 경우 영양과 환경에 대한 개선 사항을 제안한다.

기존의 파각란 솔루션이 생산, 선별, 이동, 유통, 저장 등 단편적인 솔루션에 머물렀다면, 스 파이에그는 ‘농장에서 식탁까지’ 전주기 데이터를 수집하여 리스크를 관리한다.

체계화되어 수집된 빅데이터는 양계 농장의 데이터 즉, 온습도, 환경, 영양 등과 스파이에그 데이터를 통해 파각란 발생률, 등급 등을 예측할 수 있는 AI 모델 개발에 활용할 것이다.



## 데이터 활용

<img src="/images/2024-03-18-spyegg/image-20240318204225828.png" alt="image-20240318204225828" style="zoom:50%;" />

하지만 이러한 데이터는 홀로 사용될 수 없다. 파각란은 더 다양한 조건에 영향을 받는다. 

월령과 품종, 사양환경에 따라 난각의 성질이 달라지는데, 한 예시로 산란계의 월령에 따라 파각의 임계점이 낮다. 

또한 비슷한 성질의 난각을 가진 계란이더라도, 채란 방식에 따라, 즉, 수동식으로 사람의 손을 거치는가와 혹은 자동화가 이루어지는가에 따라 달라질 수 있으며, 서로 다른 이동 동선에 따라서도 물리적 리스크 포인트가 발생 할 수 있다.

<img src="/images/2024-03-18-spyegg/image-20240318204303427.png" alt="image-20240318204303427" style="zoom: 33%;" />

란들의 둥근 면을 본다면 10자리의 숫자가 씌여있는 것을 볼 수 있다. 

앞 4자리는 산란일자, 이후 5자리는 생산자 고유번호, 나머지 한자리는 사육 환경을 나타낸다. 

'SpyEgg'를 통해 직접 추출한 데이터와 공공데이터를 융합하여 이용한다.

이 10자리 번호를 통해 언제 어떤 농장에서 생산되고, 어떤 집하장에서 모여지고, 어떤 브랜드를 이루는 지 알 수 있다. 

또한 산란계들의 일령과 사육환경까지 알 수 있습니다. 이를 통해 파각란에 영향을 주는 일령, 계절 주기 데이터를 알 수 있다.

<img src="/images/2024-03-18-spyegg/image-20240318204452504.png" alt="image-20240318204452504" style="zoom:50%;" />

또한, 파각란에 대한 정보뿐 아니라 축산물품질평가원-축산유통정보의 공공데이터를 활용하여 매일 최신화된 계란 산지 가격과 계란 도매가격을 산란계 농장에게 제공한다.

 이를 통해 농가의 수익량을 예측한다. 동일 조건 농가 별 비교를 통해 지속적인 피드백과 성장을 이루어 낸다.

```python
import requests
from bs4 import BeautifulSoup
import pandas as pd
from html_table_parser import parser_functions as parser

# 웹 페이지의 URL 설정
domae_url = 'https://www.ekapepia.com/priceStat/distrDomaePriceEgg.do?menuId=menu100209&boardInfoNo='

# 웹 페이지 요청
response = requests.get(domae_url)

# BeautifulSoup을 사용하여 HTML 파싱
soup = BeautifulSoup(response.text, 'html.parser')

# 데이터 추출
data = soup.find('table')

table = parser.make2d(data)
df = pd.DataFrame(data=table[2:],columns=table[0])
df.to_csv('domae.csv')
```

```R
ggplot(domae, aes(x = 구분)) +
  geom_line(aes(y = 왕란, color = "왕란"), size= 1.5) +
  geom_line(aes(y = 특란, color = "특란"), size= 1.5) +
  geom_line(aes(y = 대란, color = "대란"), size= 1.5) +
  geom_line(aes(y = 중란, color = "중란"), size= 1.5) +
  labs(x = "날짜", y = "계란가격(30개당)", color="구분", 
       title = "계란 크기별 도매 가격") +
  scale_color_manual(
    values = c("왕란" = "#FFB6C1", "특란" = "#B2EC5D", "대란" = "#CDB4DB", "중란" = "#AED6F1"),
    breaks = c("왕란", "특란", "대란", "중란"),
    labels = c("왕란", "특란", "대란", "중란")
  ) +
  scale_x_date(
    labels = date_format("%m-%d"),
    date_breaks = "5 day"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5,size=17,face='bold',family = "NanumGothic"),
    axis.text = element_text(family = "NanumGothic"),
    axis.title = element_text(family = "NanumGothic"),
    legend.title = element_text(family = "NanumGothic"),
    legend.text = element_text(family = "NanumGothic")
  ) -> q
```

<br>

<br>위는 최신화된 가격을 크롤링하는 과정과 시각화 코드 예시이다.

<br>

## **웹 구현**





<img src="/images/2024-03-18-spyegg/KakaoTalk_20230718_210616407.gif" alt="KakaoTalk_20230718_210616407" style="zoom:50%;" />         <img src="/images/2024-03-18-spyegg/KakaoTalk_20230718_210613157.gif" alt="KakaoTalk_20230718_210613157" style="zoom:50%;" />

<br>



웹을 통해 데이터를 입력받고 아웃풋을 제공하는 서비스를 제작하고자 했다. 

농장이 가지고 있는 자체 데이터(여기서는 파각란 비율과 농장 환경), 공공데이터를 활용 한 정보들로 비슷한 지역과 월령의 산란계 농장을 볼 수 있다.



<img src="/images/2024-03-18-spyegg/123123123.gif" alt="123123123" style="zoom:50%;" /><img src="/images/2024-03-18-spyegg/1123123.gif" alt="1123123" style="zoom:50%;" />

<br>

다음은 충주의 한 산란계 농장을 방문해서 모의로 컨설팅을 한 모습이다. 

산란계 농장 의 생산 환경에서 SpyEgg를 통해 데이터를 추출하고, 이를 시각화 했다. 

그 후 충격량 이 높게 측정된 곳에, 완충제를 설치하고, 레일의 단폭을 줄이고, 기울기를 줄이는 등, 여러 조치를 취한 후 달라진 충격량을 측정한 모습이다. 

공공데이터와 난각을 부수면서 만든 데이터를 통해, 붉은색으로 만든 임계점을 설정하였고, 임계점이 넘는 부분을 컨설팅 하였다.



## **비즈니스 모델**

<img src="/images/2024-03-18-spyegg/image-20240318210354395.png" alt="image-20240318210354395" style="zoom:50%;" />

수입구조는 컨설팅이다. 하지만 단순 컨설팅 뿐만 아니라, 차후 파각란 감소를 위한 제품(첨가제, 완충제, 선별기 등)과의 연계 판매를 통해 서비스를 확장해나갈 생각이다. 

진단한 결과에 따라 추가적인 제품을 처방하고 AI 고도화와 데이터 수집의 체계화를 이루어 인력을 최소화하며 여러 농가를 한번에 관리 할 수 있다. 

스파이에그의 데이터와 농장 자체 데이터를 입력하면, 즉각적인 결과치를 보고 조치할 수 있다. 

또한 정부에서는 데이터 기반의 1차산업을 위해 많은 지원을 하고 있다. 

데이터 기반의 ICT장비와 센서를 구매하는데 정부에서 금전적인 지원을 하고 있으며, 이를 통해 지원하는 초기 농가들의 참여를 이끌어 낼 수 있다.



## **기대효과**

그래서 결과적으로 SpyEgg를 하면 뭐가 좋은데? 라고 묻는다면, 다음과 같이 답할 수 있다. 

더 높은 등급의 계란을 생산하게 되면, 더 나은 가격으로 판매할 수 있게 됩니다. 농 가의 소득 증대와 대불어, 각 식용란 수집업체의와 농가의 브랜드 가치를 향상시키게 된다.

다음으론 소비자는 이 서비스를 통해 향상된 품질의 계란을 구입할 수 있게 된다. 

또한, 계란의 유통과정과 평가과정이 객관적으로 이루어져서, 소비자의 농가에 대한 신뢰도가 증가한다.

마지막으로 파각란 감소는 낭비를 줄이고 자원의 효율적인 활용을 가능한다. 

이는 환경 보호와 지속가능한 농업 실현에 기여하게 된다.

이처럼, 'SpyEgg'는 계란 산업의 생산성을 향상시키는 데 기여하며, 국내 시장 뿐만 아니라전 세계적인 시장으로 확장 가능한 서비스이다. 

<img src="/images/2024-03-18-spyegg/image-20240318211744973.png" alt="image-20240318211744973" style="zoom:50%;" />

계란은 전 세계적으로 중요한 산업이며, 155조가 넘는 시장을 보유하고 있으며, 7천800만톤의 생산량을 지니고 있다. 

계란은 종교, 문화적으로 영향을 받지 않는 동물성 영양소 공급원이며, 이에 따라 계란 시장은 꾸준히 성장하는 추세다.

한 짧은 예로, 전 세계의 파각란 때문에 나타나는 경제적 손실은 대략 1조 5천억원이다. 

만약 파각란을 1%만 줄인다면 3000 억원 이상의 경제적 가치를 창출할 수 있다.



## ***팀소개***

저를 비롯하여 팀 공공의란은 축산학을 공부하는 사람들입니다. 

많은 분들이 저희 스스로 를 소개할 때 농업, 축산에 생소함을 느끼고 신기해하는 사람들이 많습니다. 

저는 이 생소함 이 경험과 감각에 의존하는 데에서 나온다고 생각합니다. 

경험적 판단이 나쁜 것은 아니지만, 누구나 그 경험을 가지고 있지 않습니다. 

데이터 기반의 농업을 통해 농가와 소비자의 진입장 벽을 낮추고, **과거 1차산업이 받던 존중과 사랑이 회복될 수 있었으면 좋겠습니다.**





### **수상내역**

---

<img src="/images/2024-03-18-spyegg/image-20240318221847316.png" alt="image-20240318221847316" style="zoom: 50%;" />

<img src="/images/2024-03-18-spyegg/image-20240319144709892.png" alt="image-20240319144709892" style="zoom:50%;" />



<img src="/images/2024-03-18-spyegg/image-20240319144727213.png" alt="image-20240319144727213" style="zoom:50%;" />







---

### **보도자료**

[대한민국 정책브리핑 - 농식품 청년창업, 공공데이터가 이끈다!](https://www.korea.kr/briefing/pressReleaseView.do?newsId=156585694)

[푸드아이콘-농식품 공공‧빅데이터 활용. 창업경진대회 15개 우수작 시상](https://www.foodicon.co.kr/news/articleView.html?idxno=22322)

[팜앤마켓-‘공공데이터’로 농식품 청년창업 이끈다!](https://www.farmnmarket.com/news/article.html?no=19871)

[더농부-농림축산식품 공공빅데이터 활용. 창업경진대회](https://m.blog.naver.com/nong-up/223190587942)

[농식품부, 공공·빅데이터 창업경진대회 15개 우수작 시상](https://www.shinailbo.co.kr/news/articleView.html?idxno=1746750)

[부산일보 - 시설재배에 1분단위 생육환경 제공’ 농축산식품 창업경진대회 대상](https://www.busan.com/view/busan/view.php?code=2023081719073801324)





#### **_<u>Reference</u>_**

- [Github](https://github.com/Spyegg/spyegg)
- [Notion](https://dusty-caboc-f27.notion.site/Award-c153f1e2ac4246b6af26692327b1e800)
